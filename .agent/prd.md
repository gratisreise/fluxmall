## [요구사항 정의서] 이커머스 MVP (세션 기반 인증 및 재고 선점형)

### 1. 서비스 개요

- **목적:** 회원 인증을 기반으로 상품을 탐색하고, 재고 선점 과정을 거쳐 주문 및 결제를 완료하는 이커머스 핵심 루프 구현
- **사용자:** 비회원(조회 가능), 회원(주문/결제 가능)

---

### 2. 주요 기능 요구사항

### 2.1 회원 관리 및 인증 (Member & Session)

- **기능 요약:** 사용자 식별 및 서비스 이용 권한 관리
- **사용자 액션:** * 이메일과 비밀번호를 입력하여 회원가입 및 로그인
    - 로그아웃을 통한 세션 종료
- **서버 동작:**
    - 로그인 성공 시 서버 세션에 회원 정보를 저장하고, 브라우저에 세션 쿠키를 발급하여 이후 요청에서 사용자를 식별함
- **예외 케이스:** * 로그인하지 않은 상태에서 주문/결제 시도 시 로그인 페이지로 유도(401 Unauthorized)
    - 중복 이메일 가입 방지

### 2.2 상품 탐색 (Product)

- **기능 요약:** 판매 중인 상품 정보를 확인
- **사용자 액션:** 상품 목록 열람 및 특정 상품의 상세 설명(가격, 재고 등) 확인
- **서버 동작:** * DB에 저장된 상품 정보를 조회하여 전달
    - 재고가 0인 상품은 '품절' 상태로 표시
- **비기능 요구사항:** 비회원도 자유롭게 조회할 수 있도록 접근 제어 설정

### 2.3 주문 생성 및 재고 선점 (Order & Inventory)

- **기능 요약:** 결제 전 단계에서 상품을 확보(선점)하고 주문서를 생성
- **사용자 액션:** 상품 상세 페이지에서 '구매하기' 버튼 클릭
- **서버 동작 (CRUD: Create/Update):**
    - **재고 차감:** 주문 요청 수량만큼 상품의 실제 재고를 즉시 차감함
    - **주문서 생성:** '결제 대기' 상태의 주문 레코드를 생성함
- **예외 케이스:** * 주문 수량이 현재 재고보다 많을 경우 주문 불가 알림
    - 선점 후 일정 시간(예: 10분) 내 결제 미완료 시 재고 복구 및 주문 자동 취소

### 2.4 결제 및 주문 확정 (Payment)

- **기능 요약:** 주문서에 대한 결제를 완료하여 최종 구매 확정
- **사용자 액션:** 주문서 화면에서 결제 승인 요청
- **서버 동작 (CRUD: Update):**
    - 내부 로직을 통해 결제 성공/실패 여부를 판별
    - 성공 시 주문 상태를 '결제 완료'로 변경
- **예외 케이스:** * 결제 실패 시 차감된 재고를 다시 상품 재고로 복구(Rollback)

---

### 3. 개발 관점의 핵심 체크포인트

- **데이터 엔티티 후보:**
    - **Member:** 이메일, 암호화된 비밀번호, 성함, 세션 정보
    - **Product:** 상품명, 가격, **잔여 재고량**, 판매 상태
    - **Order:** 회원 정보 외래키, 주문 상태(대기/완료/취소), 총 결제 금액
- **서버 책임 영역:**
    - 세션 관리 (발급/검증/만료)
    - **재고 정합성 보장:** 여러 사용자가 동시 주문 시 재고가 음수가 되지 않도록 동시성 제어 로직 적용
- **클라이언트 책임 영역:**
    - 세션 쿠키 저장 및 요청 시 전달
    - 로그인 상태에 따른 UI 처리 (구매 버튼 활성화 여부 등)